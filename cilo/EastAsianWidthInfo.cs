
namespace cilo
{
    static class EastAsianWidthInfo
    {

        public static EastAsianWidthTypes GetEastAsianWidthType(this char value)
        {
            // search EAW with binary search
            int low = 0;
            int high = entriesWithoutN.Length - 1;
            while (low <= high)
            {
                var i = (low + high) / 2;
                var candidate = entriesWithoutN[i];
                if (value < candidate.Start)
                {
                    high = i - 1;
                }
                else if (value > candidate.End)
                {
                    low = i + 1;
                }
                else
                {
                    return candidate.Type;
                }
            }
            return EastAsianWidthTypes.N;
        }

        static readonly EastAsianWidthEntry[] entriesWithoutN = new[]
        {
            new EastAsianWidthEntry(32, 126, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(161, 161, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(162, 163, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(164, 164, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(165, 166, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(167, 168, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(170, 170, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(172, 172, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(173, 174, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(175, 175, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(176, 180, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(182, 186, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(188, 191, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(198, 198, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(208, 208, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(215, 216, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(222, 225, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(230, 230, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(232, 234, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(236, 237, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(240, 240, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(242, 243, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(247, 250, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(252, 252, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(254, 254, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(257, 257, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(273, 273, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(275, 275, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(283, 283, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(294, 295, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(299, 299, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(305, 307, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(312, 312, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(319, 322, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(324, 324, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(328, 331, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(333, 333, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(338, 339, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(358, 359, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(363, 363, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(462, 462, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(464, 464, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(466, 466, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(468, 468, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(470, 470, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(472, 472, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(474, 474, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(476, 476, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(593, 593, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(609, 609, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(708, 708, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(711, 711, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(713, 715, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(717, 717, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(720, 720, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(728, 731, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(733, 733, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(735, 735, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(768, 879, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(913, 937, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(945, 961, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(963, 969, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(1025, 1025, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(1040, 1103, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(1105, 1105, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(4352, 4447, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(8208, 8208, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8211, 8214, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8216, 8217, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8220, 8221, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8224, 8226, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8228, 8231, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8240, 8240, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8242, 8243, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8245, 8245, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8251, 8251, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8254, 8254, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8308, 8308, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8319, 8319, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8321, 8324, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8361, 8361, EastAsianWidthTypes.H),
            new EastAsianWidthEntry(8364, 8364, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8451, 8451, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8453, 8453, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8457, 8457, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8467, 8467, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8470, 8470, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8481, 8482, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8486, 8486, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8491, 8491, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8531, 8532, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8539, 8542, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8544, 8555, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8560, 8569, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8585, 8585, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8592, 8601, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8632, 8633, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8658, 8658, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8660, 8660, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8679, 8679, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8704, 8704, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8706, 8707, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8711, 8712, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8715, 8715, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8719, 8719, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8721, 8721, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8725, 8725, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8730, 8730, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8733, 8736, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8739, 8739, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8741, 8741, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8743, 8748, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8750, 8750, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8756, 8759, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8764, 8765, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8776, 8776, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8780, 8780, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8786, 8786, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8800, 8801, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8804, 8807, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8810, 8811, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8814, 8815, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8834, 8835, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8838, 8839, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8853, 8853, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8857, 8857, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8869, 8869, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8895, 8895, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8978, 8978, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(8986, 8987, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9001, 9002, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9193, 9196, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9200, 9200, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9203, 9203, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9312, 9449, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9451, 9547, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9552, 9587, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9600, 9615, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9618, 9621, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9632, 9633, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9635, 9641, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9650, 9651, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9654, 9655, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9660, 9661, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9664, 9665, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9670, 9672, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9675, 9675, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9678, 9681, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9698, 9701, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9711, 9711, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9725, 9726, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9733, 9734, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9737, 9737, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9742, 9743, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9748, 9749, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9756, 9756, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9758, 9758, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9792, 9792, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9794, 9794, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9800, 9811, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9824, 9825, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9827, 9829, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9831, 9834, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9836, 9837, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9839, 9839, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9855, 9855, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9875, 9875, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9886, 9887, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9889, 9889, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9898, 9899, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9917, 9918, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9919, 9919, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9924, 9925, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9926, 9933, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9934, 9934, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9935, 9939, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9940, 9940, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9941, 9953, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9955, 9955, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9960, 9961, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9962, 9962, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9963, 9969, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9970, 9971, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9972, 9972, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9973, 9973, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9974, 9977, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9978, 9978, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9979, 9980, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9981, 9981, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9982, 9983, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(9989, 9989, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(9994, 9995, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10024, 10024, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10045, 10045, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(10060, 10060, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10062, 10062, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10067, 10069, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10071, 10071, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10102, 10111, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(10133, 10135, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10160, 10160, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10175, 10175, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(10214, 10221, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(10629, 10630, EastAsianWidthTypes.Na),
            new EastAsianWidthEntry(11035, 11036, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(11088, 11088, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(11093, 11093, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(11094, 11097, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(11904, 12283, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(12288, 12288, EastAsianWidthTypes.F),
            new EastAsianWidthEntry(12289, 12350, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(12353, 12871, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(12872, 12879, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(12880, 19903, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(19968, 42182, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(43360, 43388, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(44032, 55203, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(57344, 63743, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(63744, 64255, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(65024, 65039, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(65040, 65049, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(65072, 65131, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(65281, 65376, EastAsianWidthTypes.F),
            new EastAsianWidthEntry(65377, 65500, EastAsianWidthTypes.H),
            new EastAsianWidthEntry(65504, 65510, EastAsianWidthTypes.F),
            new EastAsianWidthEntry(65512, 65518, EastAsianWidthTypes.H),
            new EastAsianWidthEntry(65533, 65533, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(94176, 111355, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(126980, 126980, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127183, 127183, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127232, 127242, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127248, 127277, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127280, 127337, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127344, 127373, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127374, 127374, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127375, 127376, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127377, 127386, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127387, 127404, EastAsianWidthTypes.A),
            new EastAsianWidthEntry(127488, 127776, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127789, 127797, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127799, 127868, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127870, 127891, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127904, 127946, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127951, 127955, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127968, 127984, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127988, 127988, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(127992, 128062, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128064, 128064, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128066, 128252, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128255, 128317, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128331, 128334, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128336, 128359, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128378, 128378, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128405, 128406, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128420, 128420, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128507, 128591, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128640, 128709, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128716, 128716, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128720, 128722, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128725, 128725, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128747, 128748, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128756, 128762, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(128992, 129003, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(129293, 129535, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(129648, 262141, EastAsianWidthTypes.W),
            new EastAsianWidthEntry(917760, 1114109, EastAsianWidthTypes.A),
        };

    }

    enum EastAsianWidthTypes
    {
        N,
        F,
        H,
        W,
        Na,
        A,
    }

    struct EastAsianWidthEntry
    {
        public EastAsianWidthEntry(int start, int end, EastAsianWidthTypes type)
        {
            this.Start = start;
            this.End = end;
            this.Type = type;
        }

        public readonly int Start;
        public readonly int End;
        public readonly EastAsianWidthTypes Type;

        public override string ToString() => $"[{this.Start}, {this.End}] {this.Type}";
    }

}
